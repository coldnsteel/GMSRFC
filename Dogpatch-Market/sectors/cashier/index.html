<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ°Ô∏è Crypto Cashier - GMSRFC</title>
    <!-- v2.11.0, 2025-09-08 -->
    <style>
        body { 
            background: #1a1a1a; 
            color: #ffffff; 
            font-family: monospace; 
            padding: 20px; 
            margin: 0;
        }
        .debug-box { 
            background: #000; 
            border: 2px solid #00aaff; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px;
        }
        .error { color: #ff4444; } 
        .success { color: #44ff44; } 
        .warning { color: #ffaa00; }
        .crypto-btn { 
            background: #ff1493; 
            color: white; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 10px 5px; 
            font-size: 14px;
            font-weight: bold;
        }
        .crypto-btn:hover {
            background: #ff69b4;
            transform: translateY(-2px);
        }
        .venmo-btn { 
            background: #3d95ce; 
            color: white; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 10px 5px; 
            font-size: 14px;
            font-weight: bold;
        }
        .venmo-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        .crypto-address { 
            background: #333; 
            color: #ffffff; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            font-size: 0.9em; 
            word-break: break-all; 
            border: 1px solid #555;
        }
        .copy-btn { 
            background: #0070ba; 
            color: white; 
            padding: 8px 15px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px 0; 
        }
        .copy-btn:hover {
            background: #0056b3;
        }
        .download-btn { 
            background: #00ced1; 
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 10px 0; 
            text-decoration: none;
            display: inline-block;
        }
        .download-btn:hover {
            background: #00b8d4;
        }
        .cashier-container { 
            background: linear-gradient(135deg, rgba(106, 90, 205, 0.3), rgba(255, 105, 180, 0.3)); 
            border: 4px solid #ff69b4; 
            border-radius: 25px; 
            padding: 25px; 
            max-width: 90%; 
            width: 700px; 
            text-align: center; 
            margin: 0 auto;
        }
        .cashier-title { 
            color: #00ff7f; 
            font-size: 2.2em; 
            margin-bottom: 15px; 
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
        }
        .cashier-text { 
            color: #ffffff; 
            font-size: 1.3em; 
            margin: 15px 0; 
            font-weight: bold;
        }
        .test-url { 
            background: #333; 
            color: #00ff7f; 
            padding: 12px; 
            margin: 10px 0; 
            border-radius: 8px; 
            font-size: 0.9em; 
            word-break: break-all; 
            cursor: pointer; 
            border: 1px solid #555;
        }
        .test-url:hover {
            background: #444;
        }
        #debug-output {
            max-height: 200px;
            overflow-y: auto;
            text-align: left;
        }
        @media (max-width: 480px) { 
            body { font-size: 14px; } 
            .cashier-container { padding: 15px; width: 95%; } 
            .cashier-title { font-size: 1.8em; } 
            .crypto-btn, .venmo-btn { padding: 10px 16px; margin: 8px 3px; }
        }
    </style>
</head>
<body>
    <div class="cashier-container">
        <h1 class="cashier-title">üõ°Ô∏è Kozmic Cashier üåå</h1>
        <p class="cashier-text" id="purchaseInfo">Processing your purchase...</p>
        
        <div class="debug-box">
            <h3 style="color: #00aaff;">URL Debug Output:</h3>
            <div id="debug-output">Loading...</div>
        </div>
        
        <div class="debug-box">
            <h3 style="color: #00aaff;">Test URL (Copy & Paste):</h3>
            <div class="test-url" onclick="copyTestUrl()">
                https://coldnsteel.github.io/GMSRFC/Dogpatch-Market/sectors/cashier/index.html?item=fortress-pass&amount=19
            </div>
            <small style="color: #ffaa00;">Click above to copy, then paste in new tab</small>
        </div>
        
        <div class="debug-box">
            <h3 style="color: #00aaff;">Payment Options:</h3>
            <button class="venmo-btn" onclick="showPayment('venmo')">üí∞ Pay with Venmo</button>
            <button class="crypto-btn" onclick="showPayment('bitcoin')">ü™ô Pay with Bitcoin</button>
            <button class="crypto-btn" onclick="showPayment('ethereum')">üíé Pay with Ethereum</button>
            <button class="crypto-btn" onclick="showPayment('ctok')">üåü Pay with CTOK</button>
            <div class="crypto-address" id="paymentAddress" style="display: none;"></div>
            <button class="copy-btn" id="copyBtn" style="display: none;" onclick="copyAddress()">Copy Address</button>
        </div>
        
        <div class="debug-box" id="downloadSection" style="display: none;">
            <h3 style="color: #00aaff;">Access Product:</h3>
            <div id="downloadInfo" style="color: #ffffff;"></div>
            <a id="downloadLink" class="download-btn" style="display: none;">Access Now</a>
        </div>
        
        <p style="color: #ff69b4; text-align: center; margin: 15px 0;">
            <a href="../index.html" style="color: #00ff7f;">üõí Dogpatch Market</a>
        </p>
        <p style="color: #ff69b4; text-align: center;">üîë Code: Cashier_Fortress_v2.11.0 | Token: œàŒ©¬ß‚àû | Mission: STARCOM-0908-LS-GMSRFC-DOGPATCH-V211</p>
    </div>
    
    <script>
        const products = {
            'fortress-pass': { type: 'access', url: '/Dogpatch-Market/assets/fortress-pass.txt', name: 'HackerWatch Fortress Pass' },
            'psi-omega-access': { type: 'access', url: '/Dogpatch-Market/assets/psi-omega-access.txt', name: 'Psi-Omega Access' },
            'gmsrfc-docs': { type: 'file', url: '/Dogpatch-Market/assets/gmsrfc-docs.txt', name: 'GMSRFC Documentation' },
            'reviewer-code': { type: 'access', url: '/Dogpatch-Market/assets/reviewer-code.txt', name: 'Reviewer Code Access' },
            'comedy-show': { type: 'access', url: '/studios/comedy-lounge/jokebox.html', name: 'Comedy Lounge Access' }
        };

        function debugLog(message, type = 'info') {
            const output = document.getElementById('debug-output');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : '';
            output.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
        }

        function getQueryParams() {
            try {
                const search = window.location.search;
                debugLog(`Raw URL search: ${search || 'EMPTY'}`);
                if (!search) {
                    debugLog('‚ö†Ô∏è No URL parameters - use test URL above', 'warning');
                    return null;
                }
                const params = new URLSearchParams(search);
                const item = params.get('item') || 'NOT_FOUND';
                const amount = params.get('amount') || 'NOT_FOUND';
                debugLog(`Raw params - item: ${item} amount: ${amount}`);
                const numAmount = parseFloat(amount);
                debugLog(`Final params - item: ${item} amount: ${numAmount}`);
                if (item === 'NOT_FOUND' || amount === 'NOT_FOUND') {
                    debugLog('‚ùå URL parameters missing', 'error');
                    return null;
                }
                if (isNaN(numAmount)) {
                    debugLog('‚ùå Invalid amount value', 'error');
                    return null;
                }
                debugLog('‚úÖ URL parameters parsed successfully', 'success');
                return { item, amount: numAmount };
            } catch (error) {
                debugLog(`‚ùå Error parsing query params: ${error.message}`, 'error');
                return null;
            }
        }

        function copyTestUrl() {
            const url = 'https://coldnsteel.github.io/GMSRFC/Dogpatch-Market/sectors/cashier/index.html?item=fortress-pass&amount=19';
            navigator.clipboard.writeText(url).then(() => {
                debugLog('‚úÖ Test URL copied to clipboard', 'success');
            }).catch(() => {
                debugLog('‚ö†Ô∏è Copy failed - manually copy URL above', 'warning');
            });
        }

        function showPayment(method) {
            const params = getQueryParams();
            if (!params) return;
            const { item, amount } = params;
            const paymentAddress = document.getElementById('paymentAddress');
            const copyBtn = document.getElementById('copyBtn');
            let address = '';
            
            if (method === 'venmo') {
                address = '@karla-Gottschalk';
                paymentAddress.innerHTML = `<strong>Venmo Payment</strong><br>Username: ${address}<br>Amount: $${amount}<br>Note: Kozmic Kollections - ${item}<br>Send payment, then refresh with ?tx=[your_venmo_transaction_id]<br><br><em>Business: Kozmic Kollections and PlayLand (@HolySoul)</em>`;
                copyBtn.innerText = 'Copy Venmo Username';
            } else if (method === 'bitcoin') {
                address = 'bc1qvevxcage66n8j86rtzvxn8xrzw9k5nOp5fxg';
                paymentAddress.innerHTML = `<strong>Bitcoin Payment</strong><br>Address: ${address}<br>Amount: $${amount} (convert to BTC using your wallet)<br>Note: Psi-Omega Purchase - ${item}<br>Send payment, then refresh with ?tx=[your_tx_id]`;
                copyBtn.innerText = 'Copy Bitcoin Address';
            } else if (method === 'ethereum') {
                address = '0xfD9FD0c94caf9AdDbEd6c968504cC47f2638C158';
                paymentAddress.innerHTML = `<strong>Ethereum Payment</strong><br>Address: ${address}<br>Amount: $${amount} (convert to ETH using your wallet)<br>Note: Psi-Omega Purchase - ${item}<br>Send payment, then refresh with ?tx=[your_tx_id]`;
                copyBtn.innerText = 'Copy Ethereum Address';
            } else if (method === 'ctok') {
                address = 'CTOK payments coming soon!';
                paymentAddress.innerHTML = `<strong>CTOK Payment</strong><br>${address}`;
            }
            
            paymentAddress.style.display = 'block';
            copyBtn.style.display = method !== 'ctok' ? 'block' : 'none';
            debugLog(`‚úÖ Showing ${method} payment for ${item} - $${amount}`, 'success');
            
            const log = JSON.parse(localStorage.getItem('securityLog') || '[]');
            log.push({ 
                issue: `Payment initiated: ${item} ($${amount}) via ${method}`, 
                timestamp: new Date().toISOString(), 
                source: 'KozmicCashier', 
                token: 'œàŒ©¬ß‚àû',
                venmo: method === 'venmo' ? '@karla-Gottschalk' : null
            });
            localStorage.setItem('securityLog', JSON.stringify(log));
        }

        function copyAddress() {
            try {
                const paymentAddress = document.getElementById('paymentAddress').innerHTML;
                let addressToCopy = '';
                
                if (paymentAddress.includes('Venmo')) {
                    addressToCopy = '@karla-Gottschalk';
                } else {
                    const addressMatch = paymentAddress.match(/(bc1[a-zA-Z0-9]+|0x[a-fA-F0-9]+)/);
                    if (addressMatch) {
                        addressToCopy = addressMatch[0];
                    }
                }
                
                if (addressToCopy) {
                    navigator.clipboard.writeText(addressToCopy).then(() => {
                        debugLog('‚úÖ Address copied: ' + addressToCopy, 'success');
                    }).catch(() => {
                        debugLog('‚ö†Ô∏è Copy failed - manually copy address above', 'warning');
                    });
                } else {
                    debugLog('‚ùå No valid address found to copy', 'error');
                }
            } catch (error) {
                debugLog(`‚ùå Error copying address: ${error.message}`, 'error');
            }
        }

        function checkTransaction() {
            const params = new URLSearchParams(window.location.search);
            const txId = params.get('tx');
            const item = params.get('item');
            if (!txId || !item || !products[item]) {
                debugLog('‚ö†Ô∏è No transaction ID or invalid item - add ?tx=[your_tx_id] after payment', 'warning');
                return;
            }
            const product = products[item];
            const downloadSection = document.getElementById('downloadSection');
            const downloadInfo = document.getElementById('downloadInfo');
            const downloadLink = document.getElementById('downloadLink');
            downloadInfo.innerHTML = `‚úÖ Payment verified for ${product.name}.<br>Please check your payment method to confirm transaction ${txId}.`;
            if (product.type === 'file' || product.type === 'access') {
                downloadLink.href = `https://coldnsteel.github.io/GMSRFC${product.url}`;
                downloadLink.innerText = `Access ${product.name}`;
                downloadLink.style.display = 'block';
            } else {
                downloadInfo.innerHTML += `<br>No download required for ${product.name}.`;
            }
            downloadSection.style.display = 'block';
            debugLog(`‚úÖ Unlocked ${product.name} for item: ${item}`, 'success');
            const log = JSON.parse(localStorage.getItem('securityLog') || '[]');
            log.push({ issue: `Product unlocked: ${item} (tx: ${txId})`, timestamp: new Date().toISOString(), source: 'KozmicCashier', token: 'œàŒ©¬ß‚àû' });
            localStorage.setItem('securityLog', JSON.stringify(log));
        }

        document.addEventListener('DOMContentLoaded', () => {
            debugLog('üõ°Ô∏è Kozmic Cashier Debug Started');
            debugLog('Token: œàŒ©¬ß‚àû | Mission: STARCOM-0908-LS-GMSRFC-DOGPATCH-V211');
            debugLog('Payment options: Venmo (@karla-Gottschalk), BTC, ETH, CTOK', 'success');
            const params = getQueryParams();
            if (params) {
                document.getElementById('purchaseInfo').textContent = `Purchasing ${products[params.item]?.name || params.item} for $${params.amount}...`;
            } else {
                document.getElementById('purchaseInfo').textContent = 'Click test URL above to load purchase details...';
            }
            checkTransaction();
        });
    </script>
</body>
</html>
