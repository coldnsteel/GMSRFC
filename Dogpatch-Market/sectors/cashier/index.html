<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ°Ô∏è Crypto Cashier - GMSRFC</title>
    <!-- v2.10.7, 2025-08-30 -->
    <style>
        body { background: #1a1a1a; color: #00ff00; font-family: monospace; padding: 20px; }
        .debug-box { background: #000; border: 2px solid #00ff00; padding: 15px; margin: 10px 0; }
        .error { color: #ff4444; } .success { color: #44ff44; } .warning { color: #ffaa00; }
        .crypto-btn { background: #ff1493; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
        .crypto-address { background: #333; color: #00ff7f; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 0.9em; word-break: break-all; }
        .copy-btn { background: #0070ba; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; margin: 5px 0; }
        .download-btn { background: #00ced1; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px 0; }
        .cashier-container { background: linear-gradient(135deg, rgba(106, 90, 205, 0.7), rgba(255, 105, 180, 0.7)); border: 4px solid #ff69b4; border-radius: 25px; padding: 20px; max-width: 90%; width: 600px; text-align: center; }
        .cashier-title { color: #00ff7f; font-size: 2em; margin-bottom: 15px; }
        .cashier-text { color: #ff69b4; font-size: 1.2em; margin: 15px 0; }
        .test-url { background: #333; color: #00ff7f; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 0.9em; word-break: break-all; cursor: pointer; }
        @media (max-width: 480px) { body { font-size: 14px; } .cashier-container { padding: 15px; width: 95%; } .cashier-title { font-size: 1.5em; } }
    </style>
</head>
<body>
    <div class="cashier-container">
        <h1 class="cashier-title">üõ°Ô∏è Crypto Cashier üåå</h1>
        <p class="cashier-text" id="purchaseInfo">Processing your purchase...</p>
        
        <div class="debug-box">
            <h3>URL Debug Output:</h3>
            <div id="debug-output">Loading...</div>
        </div>
        
        <div class="debug-box">
            <h3>Test URL (Copy & Paste):</h3>
            <div class="test-url" onclick="copyTestUrl()">
                https://coldnsteel.github.io/GMSRFC/Dogpatch-Market/sectors/cashier/index.html?item=fortress-pass&amount=1
            </div>
            <small style="color: #ffaa00;">Click above to copy, then paste in new tab</small>
        </div>
        
        <div class="debug-box">
            <h3>Crypto Payment:</h3>
            <button class="crypto-btn" onclick="showCrypto('bitcoin')">ü™ô Pay with Bitcoin</button>
            <button class="crypto-btn" onclick="showCrypto('ethereum')">üíé Pay with Ethereum</button>
            <button class="crypto-btn" onclick="showCrypto('ctok')">üåü Pay with CTOK</button>
            <div class="crypto-address" id="cryptoAddress" style="display: none;"></div>
            <button class="copy-btn" id="copyBtn" style="display: none;" onclick="copyAddress()">Copy Address</button>
        </div>
        
        <div class="debug-box" id="downloadSection" style="display: none;">
            <h3>Download Product:</h3>
            <div id="downloadInfo"></div>
            <a id="downloadLink" class="download-btn" style="display: none;">Download Now</a>
        </div>
        
        <p style="color: #ff69b4; text-align: center; margin: 15px 0;">
            <a href="/Dogpatch-Market/index.html" style="color: #00ff7f;">üõí Dogpatch Market</a>
        </p>
        <p style="color: #ff69b4; text-align: center;">üîë Code: Cashier_Fortress_v2.10.7 | Token: œàŒ©¬ß‚àû | Mission: STARCOM-0825-LS-GMSRFC-DOGPATCH-V28</p>
    </div>
    
    <script>
        const products = {
            'fortress-pass': { type: 'access', url: '/Dogpatch-Market/assets/fortress-pass.txt', name: 'HackerWatch Fortress Pass' },
            'dino-symphony': { type: 'file', url: '/Dogpatch-Market/assets/dino-symphony.mp3', name: 'Dino Symphony MP3' },
            'aria-wallpaper': { type: 'file', url: '/Dogpatch-Market/assets/aria-wallpaper.zip', name: 'ARIA Wallpaper Pack' },
            'academy-edition': { type: 'access', url: '/Dogpatch-Market/assets/academy-edition.txt', name: 'Academy Edition Access' },
            'little-x-bundle': { type: 'file', url: '/Dogpatch-Market/assets/little-x-bundle.zip', name: 'Little X Rocket Bundle' },
            'donation': { type: 'none', url: '', name: 'Donation' },
            'reviewer-code': { type: 'access', url: '/Dogpatch-Market/assets/reviewer-code.txt', name: 'Reviewer Code Access' }
        };

        function debugLog(message, type = 'info') {
            const output = document.getElementById('debug-output');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : '';
            output.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
        }

        function getQueryParams() {
            try {
                const search = window.location.search;
                debugLog(`Raw URL search: ${search || 'EMPTY'}`);
                if (!search) {
                    debugLog('‚ö†Ô∏è No URL parameters - use test URL above', 'warning');
                    return null;
                }
                const params = new URLSearchParams(search);
                const item = params.get('item') || 'NOT_FOUND';
                const amount = params.get('amount') || 'NOT_FOUND';
                debugLog(`Raw params - item: ${item} amount: ${amount}`);
                const numAmount = parseFloat(amount);
                debugLog(`Final params - item: ${item} amount: ${numAmount}`);
                if (item === 'NOT_FOUND' || amount === 'NOT_FOUND') {
                    debugLog('‚ùå URL parameters missing', 'error');
                    return null;
                }
                if (isNaN(numAmount)) {
                    debugLog('‚ùå Invalid amount value', 'error');
                    return null;
                }
                debugLog('‚úÖ URL parameters parsed successfully', 'success');
                return { item, amount: numAmount };
            } catch (error) {
                debugLog(`‚ùå Error parsing query params: ${error.message}`, 'error');
                return null;
            }
        }

        function copyTestUrl() {
            const url = 'https://coldnsteel.github.io/GMSRFC/Dogpatch-Market/sectors/cashier/index.html?item=fortress-pass&amount=1';
            navigator.clipboard.writeText(url).then(() => {
                debugLog('‚úÖ Test URL copied to clipboard', 'success');
            }).catch(() => {
                debugLog('‚ö†Ô∏è Copy failed - manually copy URL above', 'warning');
            });
        }

        function showCrypto(method) {
            const params = getQueryParams();
            if (!params) return;
            const { item, amount } = params;
            const cryptoAddress = document.getElementById('cryptoAddress');
            const copyBtn = document.getElementById('copyBtn');
            let address = '';
            if (method === 'bitcoin') {
                address = 'bc1qvevxcage66n8j86rtzvxn8xrzw9k5nOp5fxg';
                cryptoAddress.innerHTML = `<strong>Bitcoin Payment</strong><br>Address: ${address}<br>Amount: $${amount} (convert to BTC using your wallet)<br>Note: Psi-Omega Purchase - ${item}<br>Send payment, then refresh with ?tx=[your_tx_id]`;
            } else if (method === 'ethereum') {
                address = '0xfD9FD0c94caf9AdDbEd6c968504cC47f2638C158';
                cryptoAddress.innerHTML = `<strong>Ethereum Payment</strong><br>Address: ${address}<br>Amount: $${amount} (convert to ETH using your wallet)<br>Note: Psi-Omega Purchase - ${item}<br>Send payment, then refresh with ?tx=[your_tx_id]`;
            } else if (method === 'ctok') {
                address = 'CTOK payments coming soon!';
                cryptoAddress.innerHTML = `<strong>CTOK Payment</strong><br>${address}`;
            }
            cryptoAddress.style.display = 'block';
            copyBtn.style.display = method !== 'ctok' ? 'block' : 'none';
            debugLog(`‚úÖ Showing ${method} address for ${item} - $${amount}`, 'success');
            const log = JSON.parse(localStorage.getItem('securityLog') || '[]');
            log.push({ issue: `Crypto payment initiated: ${item} ($${amount}) via ${method}`, timestamp: new Date().toISOString(), source: 'Cashier', token: 'œàŒ©¬ß‚àû' });
            localStorage.setItem('securityLog', JSON.stringify(log));
        }

        function copyAddress() {
            try {
                const cryptoAddress = document.getElementById('cryptoAddress').innerHTML;
                const addressMatch = cryptoAddress.match(/(bc1[a-zA-Z0-9]+|0x[a-fA-F0-9]+)/);
                if (addressMatch) {
                    const address = addressMatch[0];
                    navigator.clipboard.writeText(address).then(() => {
                        debugLog('‚úÖ Address copied: ' + address, 'success');
                    }).catch(() => {
                        debugLog('‚ö†Ô∏è Copy failed - manually copy address above', 'warning');
                    });
                } else {
                    debugLog('‚ùå No valid address found to copy', 'error');
                }
            } catch (error) {
                debugLog(`‚ùå Error copying address: ${error.message}`, 'error');
            }
        }

        function checkTransaction() {
            const params = new URLSearchParams(window.location.search);
            const txId = params.get('tx');
            const item = params.get('item');
            if (!txId || !item || !products[item]) {
                debugLog('‚ö†Ô∏è No transaction ID or invalid item - add ?tx=[your_tx_id] after payment', 'warning');
                return;
            }
            const product = products[item];
            const downloadSection = document.getElementById('downloadSection');
            const downloadInfo = document.getElementById('downloadInfo');
            const downloadLink = document.getElementById('downloadLink');
            downloadInfo.innerHTML = `‚úÖ Payment verified for ${product.name}.<br>Please check your wallet to confirm transaction ${txId}.`;
            if (product.type === 'file' || product.type === 'access') {
                downloadLink.href = `https://coldnsteel.github.io/GMSRFC${product.url}`;
                downloadLink.innerText = `Download ${product.name}`;
                downloadLink.style.display = 'block';
            } else {
                downloadInfo.innerHTML += `<br>No download required for ${product.name}.`;
            }
            downloadSection.style.display = 'block';
            debugLog(`‚úÖ Unlocked ${product.name} for item: ${item}`, 'success');
            const log = JSON.parse(localStorage.getItem('securityLog') || '[]');
            log.push({ issue: `Product unlocked: ${item} (tx: ${txId})`, timestamp: new Date().toISOString(), source: 'Cashier', token: 'œàŒ©¬ß‚àû' });
            localStorage.setItem('securityLog', JSON.stringify(log));
        }

        document.addEventListener('DOMContentLoaded', () => {
            debugLog('üõ°Ô∏è HackerWatch Fortress Debug Started');
            debugLog('Token: œàŒ©¬ß‚àû | Mission: STARCOM-0825-LS-GMSRFC-DOGPATCH-V28');
            debugLog('PayPal removed - crypto-only payments (BTC, ETH, CTOK)', 'success');
            const params = getQueryParams();
            if (params) {
                document.getElementById('purchaseInfo').textContent = `Purchasing ${params.item} for $${params.amount}...`;
            } else {
                document.getElementById('purchaseInfo').textContent = 'Click test URL above to load purchase details...';
            }
            checkTransaction();
        });
    </script>
</body>
</html>
