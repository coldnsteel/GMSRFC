<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ°Ô∏è Debug Cashier - GMSRFC</title>
    <!-- v2.10.3, 2025-08-30 -->
    <style>
        body { background: #1a1a1a; color: #00ff00; font-family: monospace; padding: 20px; }
        .debug-box { background: #000; border: 2px solid #00ff00; padding: 15px; margin: 10px 0; }
        .error { color: #ff4444; } .success { color: #44ff44; }
        .paypal-btn { background: #0070ba; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px 0; }
        .cashier-container { background: linear-gradient(135deg, rgba(106, 90, 205, 0.7), rgba(255, 105, 180, 0.7)); border: 4px solid #ff69b4; border-radius: 25px; padding: 20px; max-width: 90%; width: 600px; text-align: center; }
        .cashier-title { color: #00ff7f; font-size: 2em; margin-bottom: 15px; }
        .cashier-text { color: #ff69b4; font-size: 1.2em; margin: 15px 0; }
        @media (max-width: 480px) { body { font-size: 14px; } .cashier-container { padding: 15px; width: 95%; } .cashier-title { font-size: 1.5em; } }
    </style>
    <script src="https://www.paypal.com/sdk/js?client-id=BAAcgBLpvWC0hTpWPzUgniqat1loTPXOsWg2v_7PP7_qS7t79Wz0TFsJjb5WbPsOkpBJVW6yMw2IJCvCq4&components=hosted-buttons&enable-funding=venmo&currency=USD"></script>
</head>
<body>
    <div class="cashier-container">
        <h1 class="cashier-title">üõ°Ô∏è Debug Cashier üåå</h1>
        <p class="cashier-text" id="purchaseInfo">Processing your purchase...</p>
        <div class="debug-box">
            <h3>URL Debug Output:</h3>
            <div id="debug-output">Loading...</div>
        </div>
        <div class="debug-box">
            <h3>PayPal Test:</h3>
            <div id="paypal-button-container"></div>
            <button class="paypal-btn" onclick="testPayPalOld()">Test Fallback PayPal Form</button>
        </div>
        <p style="color: #ff69b4; text-align: center; margin: 15px 0;">
            <a href="/Dogpatch-Market/index.html" style="color: #00ff7f;">üõí Dogpatch Market</a>
        </p>
        <p style="color: #ff69b4; text-align: center;">üîë Code: Cashier_Fortress_v2.10.3 | Token: œàŒ©¬ß‚àû | Mission: STARCOM-0825-LS-GMSRFC-DOGPATCH-V28</p>
    </div>
    <script>
        function debugLog(message, type = 'info') {
            const output = document.getElementById('debug-output');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            output.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
        }

        function getQueryParams() {
            try {
                const search = window.location.search;
                debugLog(`Raw URL search: ${search || 'EMPTY'}`);
                const params = new URLSearchParams(search);
                const item = params.get('item') || 'NOT_FOUND';
                const amount = params.get('amount') || 'NOT_FOUND';
                debugLog(`Raw params - item: ${item} amount: ${amount}`);
                const numAmount = parseFloat(amount);
                debugLog(`Final params - item: ${item} amount: ${numAmount}`);
                if (item === 'NOT_FOUND' || amount === 'NOT_FOUND') {
                    debugLog('‚ùå URL parameters missing', 'error');
                    return null;
                }
                debugLog('‚úÖ URL parameters parsed successfully', 'success');
                return { item, amount: numAmount };
            } catch (error) {
                debugLog(`‚ùå Error parsing query params: ${error.message}`, 'error');
                return null;
            }
        }

        function testPayPalOld() {
            const params = getQueryParams();
            if (!params) return;
            const { item, amount } = params;
            if (amount < 1) {
                debugLog('‚ùå PayPal requires $1 minimum', 'error');
                return;
            }
            const form = document.createElement('form');
            form.action = 'https://www.paypal.com/cgi-bin/webscr';
            form.method = 'post';
            form.target = '_top';
            const fields = {
                'cmd': '_xclick',
                'business': 'dr.karlagottschalk@gmail.com',
                'currency_code': 'USD',
                'item_name': item,
                'amount': amount.toFixed(2),
                'return': 'https://coldnsteel.github.io/GMSRFC/Dogpatch-Market/index.html'
            };
            Object.keys(fields).forEach(key => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = fields[key];
                form.appendChild(input);
            });
            document.body.appendChild(form);
            debugLog('‚úÖ Submitting fallback PayPal form', 'success');
            form.submit();
        }

        function initPayPalSDK() {
            if (typeof paypal === 'undefined') {
                debugLog('‚ùå PayPal SDK not loaded', 'error');
                return;
            }
            paypal.HostedButtons({
                hostedButtonId: "YOUR_HOSTED_BUTTON_ID" // Replace with your actual PayPal hosted button ID
            }).render("#paypal-button-container").then(() => {
                debugLog('‚úÖ PayPal SDK button initialized', 'success');
            }).catch(err => {
                debugLog(`‚ùå PayPal SDK error: ${err.message}`, 'error');
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            debugLog('üõ°Ô∏è HackerWatch Fortress Debug Started');
            debugLog('Token: œàŒ©¬ß‚àû | Mission: STARCOM-0825-LS-GMSRFC-DOGPATCH-V28');
            const params = getQueryParams();
            if (params) {
                document.getElementById('purchaseInfo').textContent = `Purchasing ${params.item} for $${params.amount}...`;
            }
            setTimeout(initPayPalSDK, 1000);
        });
    </script>
</body>
</html>
