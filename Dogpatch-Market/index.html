<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMSRFC Unified Digital Products & Collectibles</title>
    <style>
        body { 
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1b2e 50%, #1a2332 100%); 
            color: #00ff00; 
            font-family: 'Courier New', monospace; 
            padding: 20px; 
            margin: 0;
            min-height: 100vh;
        }
        .content { position: relative; z-index: 2; }
        .header {
            text-align: center;
            background: rgba(0,0,0,0.8);
            border: 2px solid #00ff00;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .nav-tabs {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .nav-tab {
            background: rgba(51,51,51,0.8);
            color: #00ff7f;
            border: 2px solid #ff69b4;
            padding: 12px 20px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .nav-tab:hover, .nav-tab.active {
            background: #ff69b4;
            color: white;
            transform: scale(1.05);
        }
        .section {
            display: none;
            background: rgba(0,0,0,0.7);
            border: 2px solid #00ff00;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .section.active { display: block; }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .product-card {
            background: rgba(51,51,51,0.8);
            border: 2px solid #ff69b4;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(255, 105, 180, 0.3);
        }
        .product-card.sold {
            opacity: 0.5;
            border-color: #888;
        }
        .sold-badge {
            background: #ff4444;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
            display: inline-block;
            margin: 10px 0;
        }
        .product-emoji { font-size: 2em; display: block; margin: 10px 0; }
        .product-title { color: #00ff7f; margin: 10px 0; }
        .product-price { font-size: 1.3em; color: #ffd700; font-weight: bold; margin: 10px 0; }
        .product-description { color: #ccc; margin: 15px 0; line-height: 1.4; }
        .buy-btn {
            background: linear-gradient(45deg, #ff1493, #9b59b6);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
            min-width: 120px;
            text-decoration: none;
            display: inline-block;
        }
        .buy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 20, 147, 0.4);
        }
        .buy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .category-header {
            background: linear-gradient(45deg, #ff69b4, #9b59b6, #00ff7f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2em;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }
        .debug-info {
            background: rgba(0,0,0,0.8);
            border: 1px solid #00ff00;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-size: 0.9em;
        }
        .coupon-section {
            background: rgba(25,25,25,0.9);
            border: 2px solid #ffd700;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        .coupon-input {
            background: rgba(51,51,51,0.8);
            color: #00ff7f;
            border: 1px solid #ffd700;
            padding: 10px;
            border-radius: 5px;
            margin: 0 10px;
            width: 200px;
        }
        .apply-btn {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.5em;
            color: #00ff7f;
        }
        .auction-timer {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid #ff4444;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            color: #ff6666;
        }
    </style>
</head>
<body>
    <div class="content">
        <div class="header">
            <h1>GMSRFC Unified Digital Products & Collectibles</h1>
            <p><strong>Contact:</strong> Lexalytics@yahoo.com | <strong>Token:</strong> œàŒ©¬ß‚àû</p>
            <p>StarSeed Fulfillment Merged - Crypto-Only System</p>
        </div>
        
        <div class="coupon-section">
            <h3>Coupon Codes Available</h3>
            <input type="text" id="globalCoupon" class="coupon-input" placeholder="Enter coupon code">
            <button class="apply-btn" onclick="applyCoupon()">Apply Coupon</button>
            <div id="couponStatus" style="margin-top: 10px;"></div>
            <p style="font-size: 0.9em; margin-top: 10px;">Codes: LAUNCH25, FORTRESS10, STUDENT50, BETA20</p>
        </div>
        
        <div class="nav-tabs" id="navTabs">
            <div class="nav-tab active" onclick="showSection('all-products')">All Products</div>
        </div>
        
        <div id="all-products" class="section active">
            <div class="category-header">Complete Digital Catalog</div>
            <div class="loading" id="loadingMessage">Loading products...</div>
            <div class="product-grid" id="allProductsGrid"></div>
        </div>
        
        <div id="podcasts" class="section">
            <div class="category-header">Podcast Studio</div>
            <div class="product-grid">
                <div class="product-card">
                    <span class="product-emoji">üéôÔ∏è</span>
                    <h3 class="product-title">Sillyosopher Saga</h3>
                    <div class="product-price">Available Now</div>
                    <p class="product-description">Cosmic comedy podcast with philosophy and humor</p>
                    <a href="/podcasts/sillyosopher-saga.html" class="buy-btn">üéß Listen Now</a>
                </div>
                
                <div class="product-card">
                    <span class="product-emoji">üêëüé≠</span>
                    <h3 class="product-title">Sheep in Control</h3>
                    <div class="product-price">Available Now</div>
                    <p class="product-description">Comedy exploring control and chaos with cosmic humor</p>
                    <a href="/podcasts/sheep-in-control.html" class="buy-btn">üéß Listen Now</a>
                </div>
                
                <div class="product-card">
                    <span class="product-emoji">üéµüéôÔ∏è</span>
                    <h3 class="product-title">Audio Input Studio</h3>
                    <div class="product-price">Interactive</div>
                    <p class="product-description">Submit your comedy clips and audio content</p>
                    <a href="/podcasts/audio-input.html" class="buy-btn">üé§ Submit Audio</a>
                </div>
                
                <div class="product-card">
                    <span class="product-emoji">üéßüéõÔ∏è</span>
                    <h3 class="product-title">Podcast Player</h3>
                    <div class="product-price">Free Tool</div>
                    <p class="product-description">Universal podcast player for all episodes</p>
                    <a href="/podcasts/podcast-player.html" class="buy-btn">‚ñ∂Ô∏è Open Player</a>
                </div>
            </div>
        </div>
        
        <div class="debug-info">
            <strong>System Status:</strong><br>
            GMSRFC Unified Storefront - Dynamic Inventory System<br>
            Contact: Lexalytics@yahoo.com | Token: œàŒ©¬ß‚àû<br>
            Products loaded from central database
        </div>
    </div>
    
    <script>
        let products = {};
        let currentCoupon = null;
        let categoryTabs = {};
        
        // Load products from JSON
        async function loadProducts() {
            try {
                const response = await fetch('products.json');
                products = await response.json();
                console.log('Loaded products:', Object.keys(products).length);
                
                // Hide loading message
                document.getElementById('loadingMessage').style.display = 'none';
                
                // Generate category tabs
                generateCategoryTabs();
                
                // Display all products
                displayProducts('all-products');
                
            } catch (error) {
                console.error('Error loading products:', error);
                document.getElementById('loadingMessage').innerHTML = 
                    '<span style="color: #ff4444;">Error loading products. Please refresh the page.</span>';
            }
        }
        
        // Generate category tabs dynamically
        function generateCategoryTabs() {
            const categories = {};
            
            // Collect unique categories
            for (const [id, product] of Object.entries(products)) {
                if (product.status === 'available') {
                    const cat = product.category;
                    if (!categories[cat]) {
                        categories[cat] = [];
                    }
                    categories[cat].push({id, ...product});
                }
            }
            
            categoryTabs = categories;
            
            // Add category tabs to navigation
            const navTabs = document.getElementById('navTabs');
            const allTab = navTabs.querySelector('.nav-tab');
            
            // Add podcasts tab (static)
            navTabs.innerHTML += '<div class="nav-tab" onclick="showSection(\'podcasts\')">üéôÔ∏è Podcasts</div>';
            
            // Add dynamic category tabs
            for (const cat of Object.keys(categories)) {
                const emoji = getCategoryEmoji(cat);
                navTabs.innerHTML += `<div class="nav-tab" onclick="showSection('${cat}')">${emoji} ${capitalizeCategory(cat)}</div>`;
                
                // Create section for this category
                const section = document.createElement('div');
                section.id = cat;
                section.className = 'section';
                section.innerHTML = `
                    <div class="category-header">${capitalizeCategory(cat)}</div>
                    <div class="product-grid" id="${cat}-grid"></div>
                `;
                document.querySelector('.content').appendChild(section);
            }
        }
        
        // Display products in grid
        function displayProducts(sectionId) {
            let productsToShow = [];
            
            if (sectionId === 'all-products') {
                // Show all available products
                productsToShow = Object.entries(products)
                    .filter(([id, p]) => p.status === 'available')
                    .map(([id, p]) => ({id, ...p}));
            } else if (categoryTabs[sectionId]) {
                // Show products from specific category
                productsToShow = categoryTabs[sectionId];
            }
            
            const gridId = sectionId === 'all-products' ? 'allProductsGrid' : `${sectionId}-grid`;
            const grid = document.getElementById(gridId);
            
            if (!grid) return;
            
            grid.innerHTML = '';
            
            productsToShow.forEach(product => {
                const card = createProductCard(product);
                grid.appendChild(card);
            });
        }
        
        // Create product card element
        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            if (product.status === 'sold') card.classList.add('sold');
            
            let buttons = '';
            
            if (product.status === 'sold') {
                buttons = '<div class="sold-badge">SOLD</div>';
            } else if (product.freeOption) {
                buttons = `
                    <button class="buy-btn" onclick="freeDonation('${product.id}')">Free Download</button>
                    <button class="buy-btn" onclick="buyCrypto('${product.id}', ${product.price})" style="background: #28a745;">Donate $${product.price}</button>
                `;
            } else if (product.auction && product.auction.enabled) {
                buttons = `
                    <div class="auction-timer" id="timer-${product.id}">Auction ends: ${product.auction.endTime}</div>
                    <button class="buy-btn" onclick="bidAuction('${product.id}', ${product.auction.startingBid || product.price})">Bid Now $${product.auction.startingBid || product.price}</button>
                `;
            } else {
                buttons = `<button class="buy-btn" onclick="buyCrypto('${product.id}', ${product.price})">Buy Now $${product.price}</button>`;
            }
            
            card.innerHTML = `
                <span class="product-emoji">${product.emoji || 'üì¶'}</span>
                <h3 class="product-title">${product.name}</h3>
                <div class="product-price">$${product.price.toFixed(2)}</div>
                <p class="product-description">${product.description}</p>
                ${buttons}
            `;
            
            return card;
        }
        
        // Show section
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(s => s.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                event.target.classList.add('active');
                
                // Display products for this category
                if (sectionId !== 'podcasts') {
                    displayProducts(sectionId);
                }
            }
        }
        
        // Apply coupon
        function applyCoupon() {
            const code = document.getElementById('globalCoupon').value.toUpperCase();
            const status = document.getElementById('couponStatus');
            
            const coupons = {
                'LAUNCH25': { discount: 0.25, type: 'percentage' },
                'FORTRESS10': { discount: 10, type: 'fixed' },
                'STUDENT50': { discount: 0.50, type: 'percentage' },
                'BETA20': { discount: 0.20, type: 'percentage' }
            };
            
            if (coupons[code]) {
                currentCoupon = coupons[code];
                currentCoupon.code = code;
                status.innerHTML = `<div style="color: #44ff44;">${code} Applied!</div>`;
            } else if (code) {
                status.innerHTML = '<div style="color: #ff4444;">Invalid coupon code</div>';
            }
        }
        
        // Buy with crypto - redirect to cashier
        function buyCrypto(itemId, price) {
            let finalPrice = price;
            
            if (currentCoupon) {
                if (currentCoupon.type === 'fixed') {
                    finalPrice = Math.max(0, price - currentCoupon.discount);
                } else {
                    finalPrice = price * (1 - currentCoupon.discount);
                }
            }
            
            window.location.href = `sectors/cashier/index.html?item=${itemId}&amount=${finalPrice.toFixed(2)}`;
        }
        
        // Bid on auction
        function bidAuction(itemId, startingBid) {
            alert(`AUCTION BIDDING\n\nItem: ${products[itemId].name}\nStarting Bid: $${startingBid}\n\nComing soon: Real-time bidding system!`);
        }
        
        // Free donation
        function freeDonation(itemId) {
            alert(`Free download available!\n\nEmail: Lexalytics@yahoo.com\nSubject: Free Download - ${products[itemId].name}\n\nFor the good of children - donations welcome!`);
        }
        
        // Helper functions
        function getCategoryEmoji(category) {
            const emojis = {
                'security': 'üõ°Ô∏è',
                'studios': 'üé¨',
                'collectibles': 'üèÜ',
                'education': 'üìö',
                'entertainment': 'üé≠',
                'ai-tools': 'üß†',
                'platforms': 'üåê',
                'bundles': 'üì¶'
            };
            return emojis[category] || 'üì¶';
        }
        
        function capitalizeCategory(category) {
            return category
                .split('-')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', loadProducts);
    </script>
</body>
</html>
